{{ define "users/edit.html" }}
<dialog open class="modal" data-modal-type="users-edit">
    <article>
        <header>
            <h2>Измена корисника</h2>
        </header>
        <form
            hx-put="/ui/users/{{ if .User}}{{ .User.ID }}{{ else }}{{ .ID }}{{ end }}"
            hx-target="#users-table"
            hx-swap="innerHTML"
            hx-include="closest form"
            hx-on::after-request="if(event.detail.successful){const dlg=this.closest('dialog');if(dlg){dlg.close();dlg.remove();}}"
        >
            {{ if .Error }}
            <p class="error-message">{{ .Error }}</p>
            {{ end }}
            <section class="form-card">
                <div class="form-stack">
                    <div class="form-field">
                        <label for="users-edit-username">Корисничко име</label>
                        <input id="users-edit-username" name="username" value="{{ if .User}}{{ .User.Username }}{{ end }}" placeholder="нпр. admin" required>
                    </div>
                    <div class="form-field">
                        <label for="users-edit-password">Нова лозинка</label>
                        <input id="users-edit-password" type="password" name="password" placeholder="Оставите празно ако не мењате">
                    </div>
                    <div class="form-field">
                        <label for="users-edit-role">Улога</label>
                        <select id="users-edit-role" name="role">
                            <option value="user" {{ if .User}}{{ if or (eq .User.Role "user") (eq .User.Role "") }}selected{{ end }}{{ else }}selected{{ end }}>Корисник</option>
                            <option value="admin" {{ if .User}}{{ if eq .User.Role "admin" }}selected{{ end }}{{ end }}>Администратор</option>
                        </select>
                    </div>
                    <div class="form-field">
                        <label for="users-edit-city">Град</label>
                        <input id="users-edit-city" name="city" value="{{ if .User}}{{ .User.City }}{{ end }}" placeholder="нпр. Пирот">
                        <small class="muted">За обичне кориснике град је обавезан.</small>
                    </div>
                </div>
            </section>
            <footer>
                <button type="submit" class="primary">Сачувај</button>
                <button type="button" class="secondary" data-close-dialog>Откажи</button>
            </footer>
        </form>
    </article>
</dialog>
{{ end }}
