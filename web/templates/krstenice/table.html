{{ define "krstenice/table.html" }}
<div id="krstenice-table">
    <form id="krstenice-state" hidden>
        <input type="hidden" name="page_number" value="{{ .Pagination.Page }}">
        <input type="hidden" name="page_size" value="{{ .Pagination.PageSize }}">
        {{ range $key, $value := .Filters }}
        <input type="hidden" name="{{ $key }}" value="{{ $value }}">
        {{ end }}
    </form>
    {{ if .Items }}
    <p><strong>Укупно:</strong> {{ .Total }}</p>
    <table role="grid">
        <thead>
            <tr>
                <th>Број књиге</th>
                <th>Страна</th>
                <th>Беба</th>
                <th>Родитељи</th>
                <th>Храм</th>
                <th>Свештеник</th>
                <th>Крштење</th>
                <th>Статус</th>
                <th>Епархија</th>
                <th>Кум</th>
                <th>Акције</th>
            </tr>
        </thead>
        <tbody>
            {{ range .Items }}
            <tr>
                <td>{{ .Book }}</td>
                <td>{{ .Page }}</td>
                <td>
                    <strong>{{ .FirstName }} {{ .LastName }}</strong>
                </td>
                <td>
                    {{ if .ParentFirstName }}{{ .ParentFirstName }} {{ .ParentLastName }}{{ else }}-{{ end }}
                </td>
                <td>
                    {{ .TampleName }}
                </td>
                <td>
                    {{ .PriestFirstName }} {{ .PriestLastName }}
                </td>
                <td>{{ formatDate .Baptism }}</td>
                <td><span class="badge">{{ .Status }}</span></td>
                <td>{{ .EparhijaName }}</td>
                <td>{{ .GodfatherFirstName }} {{ .GodfatherLastName }}</td>
                <td>
                    <div class="table-actions">
                        <button class="secondary outline"
                            type="button"
                            hx-get="/ui/krstenice/{{ .ID }}/edit"
                            hx-target="#dialog-root"
                            hx-trigger="click"
                            hx-swap="innerHTML"
                            hx-include="#krstenice-state, #krstenice-default-state">
                            Измени
                        </button>
                        <button class="contrast outline"
                            type="button"
                            hx-delete="/api/v1/adminv2/krstenice/{{ .ID }}"
                            hx-confirm="Да ли сте сигурни да желите да обришете крштеницу?"
                            hx-target="#krstenice-table"
                            hx-include="#krstenice-state, #krstenice-default-state"
                            hx-swap="none"
                            hx-on::after-request="if(event.detail.successful && window.refreshKrsteniceTable){window.refreshKrsteniceTable();}">
                            Обриши
                        </button>
                        <a class="secondary icon-button" href="/api/v1/adminv2/krstenice-print/{{ .ID }}?preview=true" target="_blank" title="Преузми као Excel">
                            <svg viewBox="0 0 24 24" aria-hidden="true" focusable="false">
                                <path d="M6 2h9l5 5v13a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2z" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linejoin="round"/>
                                <path d="M15 2v5.5H20" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
                                <path d="M8 12h8M8 16h8M12 10v8" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/>
                            </svg>
                            <span>Excel</span>
                        </a>
                        <a class="secondary icon-button" href="/api/v1/adminv2/krstenice-print/{{ .ID }}?preview=true&amp;format=pdf" target="_blank" title="Преузми као PDF">
                            <svg viewBox="0 0 24 24" aria-hidden="true" focusable="false">
                                <path d="M6 2h9l5 5v13a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2z" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linejoin="round"/>
                                <path d="M15 2v5.5H20" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
                                <path d="M8 12.5h7M8 15.5h5.5M8 18.5h4" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/>
                            </svg>
                            <span>PDF</span>
                        </a>
                        <a class="secondary icon-button" href="/api/v1/adminv2/krstenice-print/{{ .ID }}?preview=true&amp;format=pdf&amp;template_version=2" target="_blank" title="Преузми као PDF (верзија 2)">
                            <svg viewBox="0 0 24 24" aria-hidden="true" focusable="false">
                                <path d="M6 2h9l5 5v13a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2z" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linejoin="round"/>
                                <path d="M15 2v5.5H20" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
                                <path d="M8 12.5h7M8 15.5h5.5M8 18.5h4" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/>
                            </svg>
                            <span>PDF v2</span>
                        </a>
                    </div>
                </td>
            </tr>
            {{ end }}
        </tbody>
    </table>
    {{ else }}
    <article>
        <header>Тренутно нема сачуваних крштеница.</header>
        <p>Додајте нову крштеницу преко API-ја или форме када постане доступна.</p>
    </article>
    {{ end }}

    {{ if gt .Pagination.TotalPages 1 }}
    <footer style="margin-top: 1rem; display:flex; justify-content: space-between; align-items: center;">
        <span>Страна {{ .Pagination.Page }} од {{ .Pagination.TotalPages }}</span>
        <div class="grid" style="grid-template-columns: repeat(2, auto); gap: 0.5rem;">
            {{ if .Pagination.HasPrev }}
            <button hx-get="{{ .Pagination.PrevLink }}" hx-target="#krstenice-table" hx-swap="outerHTML">Претходна</button>
            {{ end }}
            {{ if .Pagination.HasNext }}
            <button hx-get="{{ .Pagination.NextLink }}" hx-target="#krstenice-table" hx-swap="outerHTML">Следећа</button>
            {{ end }}
        </div>
    </footer>
    {{ end }}
</div>
{{ end }}
