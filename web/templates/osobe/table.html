{{ define "osobe/table.html" }}
<div id="osobe-table">
    <form id="osobe-state" hidden>
        <input type="hidden" name="page_number" value="{{ .Pagination.Page }}">
        <input type="hidden" name="page_size" value="{{ .Pagination.PageSize }}">
        {{ range $key, $value := .Filters }}
        <input type="hidden" name="{{ $key }}" value="{{ $value }}">
        {{ end }}
    </form>

    {{ if .Items }}
    <p><strong>Ukupno:</strong> {{ .Total }}</p>
    <table role="grid">
        <thead>
            <tr>
                <th>Ime</th>
                <th>Prezime</th>
                <th>Uloga</th>
                <th>Grad</th>
                <th>Status</th>
                <th>Kreirano</th>
                <th>Akcije</th>
            </tr>
        </thead>
        <tbody>
            {{ range .Items }}
            <tr>
                <td>{{ .FirstName }}</td>
                <td>{{ .LastName }}</td>
                <td>
                    {{- if eq .Role "mother" -}}Majka{{- else if eq .Role "father" -}}Otac{{- else if eq .Role "godfather" -}}Kum{{- else if eq .Role "paroh" -}}Paroh{{- else -}}-{{- end -}}
                </td>
                <td>{{ if .City }}{{ .City }}{{ else }}-{{ end }}</td>
                <td><span class="badge">{{ .Status }}</span></td>
                <td>{{ formatDate .CreatedAt }}</td>
                <td>
                    <div class="table-actions">
                        <button class="secondary outline"
                            type="button"
                            hx-get="/ui/osobe/{{ .ID }}/edit"
                            hx-target="#dialog-root"
                            hx-trigger="click"
                            hx-swap="innerHTML"
                            hx-include="#osobe-state, #osobe-default-state">
                            Izmeni
                        </button>
                        <button class="contrast outline"
                            type="button"
                            hx-delete="/ui/osobe/{{ .ID }}"
                            hx-confirm="Da li ste sigurni da zelite da obrisete osobu?"
                            hx-target="#osobe-table"
                            hx-include="#osobe-state, #osobe-default-state"
                            hx-swap="none"
                            hx-on::after-request="if(event.detail.successful && window.refreshOsobeTable){window.refreshOsobeTable();}">
                            Obrisi
                        </button>
                    </div>
                </td>
            </tr>
            {{ end }}
        </tbody>
    </table>
    {{ else }}
    <article>
        <header>Trenutno nema sacuvanih osoba.</header>
        <p>Dodajte novu osobu kako biste je kasnije povezali sa krstenicom.</p>
    </article>
    {{ end }}

    {{ if gt .Pagination.TotalPages 1 }}
    <footer style="margin-top: 1rem; display:flex; justify-content: space-between; align-items: center;">
        <span>Strana {{ .Pagination.Page }} od {{ .Pagination.TotalPages }}</span>
        <div class="grid" style="grid-template-columns: repeat(2, auto); gap: 0.5rem;">
            {{ if .Pagination.HasPrev }}
            <button hx-get="{{ .Pagination.PrevLink }}"
                    hx-target="#osobe-table"
                    hx-swap="outerHTML">
                Prethodna
            </button>
            {{ end }}
            {{ if .Pagination.HasNext }}
            <button hx-get="{{ .Pagination.NextLink }}"
                    hx-target="#osobe-table"
                    hx-swap="outerHTML">
                Sledeca
            </button>
            {{ end }}
        </div>
    </footer>
    {{ end }}
</div>
{{ end }}
