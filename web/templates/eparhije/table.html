{{ define "eparhije/table.html" }}
<div id="eparhije-table" class="data-grid-wrapper">
    <form id="eparhije-state" hidden>
        <input type="hidden" name="page_number" value="{{ .Pagination.Page }}">
        <input type="hidden" name="page_size" value="{{ .Pagination.PageSize }}">
        {{ range $key, $value := .Filters }}
        <input type="hidden" name="{{ $key }}" value="{{ $value }}">
        {{ end }}
    </form>

    {{ if .Items }}
    <p class="muted"><strong>Укупно:</strong> {{ .Total }}</p>
    <table class="result-grid" role="grid">
        <thead>
            <tr>
                <th>Назив</th>
                <th>Град</th>
                <th>Статус</th>
                <th>Креирано</th>
                <th>Акције</th>
            </tr>
        </thead>
        <tbody>
            {{ range .Items }}
            <tr>
                <td>{{ .Name }}</td>
                <td>{{ .City }}</td>
                <td><span class="badge">{{ .Status }}</span></td>
                <td>{{ formatDate .CreatedAt }}</td>
                <td>
                    <div class="table-actions">
                        <button class="icon-action"
                            type="button"
                            title="Измени"
                            aria-label="Измени"
                            hx-get="/ui/eparhije/{{ .ID }}/edit"
                            hx-target="#dialog-root"
                            hx-trigger="click"
                            hx-swap="innerHTML"
                            hx-include="#eparhije-state, #eparhije-default-state">
                            <svg viewBox="0 0 24 24" aria-hidden="true" focusable="false">
                                <path d="M4 21h4l11-11-4-4L4 17v4z" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linejoin="round"/>
                                <path d="M14 5l4 4" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/>
                            </svg>
                        </button>
                        <button class="icon-action danger"
                            type="button"
                            title="Обриши"
                            aria-label="Обриши"
                            hx-delete="/ui/eparhije/{{ .ID }}"
                            hx-confirm="Да ли сте сигурни да желите да обришете епархију?"
                            hx-target="#eparhije-table"
                            hx-include="#eparhije-state, #eparhije-default-state"
                            hx-swap="none"
                            hx-on::after-request="if(event.detail.successful && window.refreshEparhijeTable){window.refreshEparhijeTable();}">
                            <svg viewBox="0 0 24 24" aria-hidden="true" focusable="false">
                                <path d="M5 7h14" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/>
                                <path d="M9 7V5h6v2" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/>
                                <path d="M8 7v11a1 1 0 0 0 1 1h6a1 1 0 0 0 1-1V7" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linejoin="round"/>
                            </svg>
                        </button>
                    </div>
                </td>
            </tr>
            {{ end }}
        </tbody>
    </table>
    {{ else }}
    <article>
        <header>Тренутно нема сачуваних епархија.</header>
        <p>Додајте нову епархију како бисте започели евиденцију.</p>
    </article>
    {{ end }}

    {{ if gt .Pagination.TotalPages 1 }}
    <footer style="margin-top: 1rem; display:flex; justify-content: space-between; align-items: center;">
        <span>Страна {{ .Pagination.Page }} од {{ .Pagination.TotalPages }}</span>
        <div class="grid" style="grid-template-columns: repeat(2, auto); gap: 0.5rem;">
            {{ if .Pagination.HasPrev }}
            <button hx-get="{{ .Pagination.PrevLink }}"
                    hx-target="#eparhije-table"
                    hx-swap="outerHTML">
                Претходна
            </button>
            {{ end }}
            {{ if .Pagination.HasNext }}
            <button hx-get="{{ .Pagination.NextLink }}"
                    hx-target="#eparhije-table"
                    hx-swap="outerHTML">
                Следећа
            </button>
            {{ end }}
        </div>
    </footer>
    {{ end }}
</div>
{{ end }}
